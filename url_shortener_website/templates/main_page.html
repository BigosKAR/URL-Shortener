{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>URL Shortener</title>
    <link rel="stylesheet" href="{% static './styles.css' %}" />
    <link
      rel="icon"
      type="image/x-icon"
      href="{% static './website_icon.png' %}"
    />
  </head>
  <body>
    <div>
      <nav id="topNav">
        <ul>
          <li><button id="logoutBtn" style="display:none;">Logout</button></li>
          <li><button id="dashboardBtn" style="display:none;">Dashboard</button></li>
          <li><button id="loginBtn">Login</button></li>
          <li><button id="signupBtn">Sign Up</button></li>
        </ul>
      </nav>
    </div>
    <div style="background-color: #e9f2ff">
    <div id="mainTitleContainer">
      <div id="mainTitleSubContainer">
        <h1 id="mainHeader">URL Shortener</h1>
        <p id="subText">
          Shorten your URL with this website! Input your URL into the designated
          area and press the "Shorten!" button. A short URL will be generated
          and displayed on the screen.
        </p>
        <div id="interactiveContainer">
          <div id="userInteractionContainer">
            <input id="userInput" placeholder="Paste your URL here..." />
            <button type="button" id="shortenButton">Shorten!</button>
          </div>
        </div>
      </div>
      <img id="urlIcon" src="{% static 'url_icon.png' %}" />
    </div>
    </div>
    <div id="outputContainer">
      <div id="shortUrlContainer">
        <a id="shortUrl"></a>
        <div>
          <button id="copyButton">
            <img id="copyImage" src="{% static 'copy_icon.png' %}" />
          </button>
          <button id="downloadQrBtn" style="display:none; margin-left:8px;">Download QR</button>
        </div>
      </div>
      <div id="errorContainer">
        <p id="errorMessage"></p>
      </div>
      {% if shortcode %}
      <div id="incorrectShortcodeContainer" style="display: flex">
        <p id="incorrectShortcodeMsg">Incorrect shortcode: {{ shortcode }}</p>
      </div>
      {% endif %}
    </div>
    {% if latest_urls %}
    <div id="urlsContainerWrapper">
      <div id="latestUrlsContainer">
        <h3 id="latestUrlsText">Recently created short URLs</h3>
        <table id="latestUrlsTable">
          <tr>
            <th>Short URL</th>
            <th>Redirects to:</th>
          </tr>
          {% for shortcode, original_url in latest_urls.items %}
          <tr>
            <td>
              <a href="{{shortcode}}"
                >{{shortcode}}</a
              >
            </td>
            <td><a href="{{ original_url }}">{{ original_url }}</a></td>
          </tr>
          {% endfor %}
        </table>
      </div>
    </div>
    {% else %}
        <div id="urlsContainerWrapper">
        <div id="latestUrlsContainer">
            <h3 id="latestUrlsText">Here you will see recently created URLs!</h3>
        </div>
        </div>
    {% endif %}
    <!-- Auth modal overlay -->
    <div id="authOverlay" class="auth-overlay" role="dialog" aria-hidden="true">
      <div class="auth-box" id="authBox">
        <button id="authClose" class="auth-close" aria-label="Close">âœ•</button>

        <div id="loginForm" class="auth-form" style="display:none;">
          <h2>Login</h2>
          <form id="loginFormElement" action="#">
            <label for="loginEmail">Email</label>
            <input id="loginEmail" type="email" required />
            <label for="loginPassword">Password</label>
            <input id="loginPassword" type="password" required />
            <div id="loginMessage" class="form-message" style="display:none"></div>
            <div class="auth-actions">
              <a href="#" id="forgotPassword">Forgot Password?</a>
              <button type="submit" class="primary-btn">Login</button>
            </div>
            <p>Don't have an account? <a href="#" id="showSignup">Sign up</a></p>
          </form>
        </div>

        <div id="signUpForm" class="auth-form" style="display:none;">
          <h2>Sign Up</h2>
          <form id="signupFormElement" action="#">
            <label for="signupEmail">Email</label>
            <input id="signupEmail" type="email" required />
            <label for="signupPassword">Password</label>
            <input id="signupPassword" type="password" required />
            <label for="signupPasswordConfirm">Confirm Password</label>
            <input id="signupPasswordConfirm" type="password" required />
            <div id="signupMessage" class="form-message" style="display:none"></div>
            <div class="auth-actions" style="justify-content:flex-end;">
              <button type="submit" class="primary-btn">Create account</button>
            </div>
            <p>Already have an account? <a href="#" id="showLogin">Login</a></p>
          </form>
        </div>

      </div>
    </div>

    <script src="{% static './main.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
  </body>
</html>
